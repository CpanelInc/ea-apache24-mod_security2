From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Dan Muey <daniel.muey@webpros.com>
Date: Thu, 22 May 2025 15:17:54 +0000
Subject: [PATCH] Adjust test for Ubuntu 20 builds

---
 tests/Makefile.am    |  1 +
 tests/logging_stub.c | 13 +++++++++++++
 2 files changed, 14 insertions(+)
 create mode 100644 tests/logging_stub.c

diff --git a/tests/Makefile.am b/tests/Makefile.am
index 130bdba..48da414 100644
--- a/tests/Makefile.am
+++ b/tests/Makefile.am
@@ -1,5 +1,6 @@
 check_PROGRAMS = msc_test
 msc_test_SOURCES = msc_test.c \
+    logging_stub.c \
     ../apache2/acmp.c \
     ../apache2/libinjection/libinjection_html5.c \
     ../apache2/libinjection/libinjection_sqli.c \
diff --git a/tests/logging_stub.c b/tests/logging_stub.c
new file mode 100644
index 0000000..c255cb7
--- /dev/null
+++ b/tests/logging_stub.c
@@ -0,0 +1,13 @@
+#include "msc_util.h"
+
+/*
+ * Stub implementation of id_log() for the test harness.
+ * Simply returns the rule's id string if present, or a placeholder.
+ */
+
+const char* id_log(msre_rule* rule) {
+    if (rule && rule->actionset && rule->actionset->id) {
+        return rule->actionset->id;
+    }
+    return "(unknown)";
+}
